<html>

	<head>

		<link rel="stylesheet" type="text/css" href="General.css">
		
		<title>
			RotairObject - Architecture conceptualized, built and installed by John Maher
		</title>
		
	</head>
	
	
	<body>

		<script type="text/javascript" src="Scripts/Common.js"></script>
		<script type="text/javascript" src="Scripts/Menu.js"></script>

		<div class="contentPlaceHolder">

			<div class="navigation" id="Navigation" style="padding-bottom: 96px;">

				<script type="text/javascript">
					Source = new Array(0);
					Init(Source);
					Source[0] = 'CustomBase'
					Source[1] = 'RotairObject'
					Source[2] = 'rotAppLockingObject'
					document.write(Menu(Source));
				</script> 			
							 
			</div>			
			
			<div class="content">

				<div class="topicContainer">
			
					<div class="topic">
	
						<h1 class="title">rotAppLockingObject Class</h1>
							  
						<div id="mainSection">
						
							<div id="mainBody">
		  
								<p>Class derived from rotAppObject.  This class extends its parent by providing logical record locking using table <a href='Tables/LogicalLocks.png'>LogicalLocks</a>.</p>
								
								<div xmlns="">
									<div class="LW_CollapsibleArea_TitleDiv">
										<div>
											<a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Collapse">
											<span class="LW_CollapsibleArea_Title">Inheritance Hierarchy</span></a>
											<div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div>
										</div>
									</div>
									<div class="sectionblock">								
										<a href="http://msdn.microsoft.com/en-us/library/system.object.aspx">System.Object</a>
										<br>&nbsp;&nbsp;<a href="rotAppObject.html">rotAppObject</a>
									</div>							
								</div><p></p>
							
								<strong>Namespace:</strong>&nbsp;<a href="RotairObject.html">RotairObject</a><br>
								<strong>Assembly:</strong>&nbsp;RotairObjects.dll
	
								<div xmlns="">
									<div class="LW_CollapsibleArea_TitleDiv">
										<div>
											<a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Collapse">
											<span class="LW_CollapsibleArea_Title">Syntax</span></a>
											<div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div>
										</div>
									</div>
									<div class="sectionblock">
										<div class="codeSnippetContainer">  	  
											<div class="codeSnippetContainerTabs">
												<div class="codeSnippetContainerTab codeSnippetContainerTabActive codeSnippetContainerTabLast" dir="ltr">
													<a>VB</a>
												</div>
											</div>
											<div class="codeSnippetContainerCodeContainer">
												<div class="codeSnippetToolBar">
												</div>
												<div class="codeSnippetContainerCode">
													<div style="color: Black;">
														<pre><span style="color: Green;">'The class rotAO_Domain will be derived from rotAppLockingObject</span></pre>
														<pre><span style="color: Blue;">Public Class</span> rotAO_Domain</pre>
														<pre><span style="color: Blue;">    Inherits</span> RotairObject.rotAppLockingObject</pre>												
													</div>				
												</div>
											</div>
										</div>
									</div>
								</div>
								<p>The <span class="selflink">rotAppLockingObject</span> type exposes the following members.</p>
	
								<div xmlns="">
									<div class="LW_CollapsibleArea_TitleDiv">
										<div>
											<a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Collapse">
											<span class="LW_CollapsibleArea_Title">Constructors</span></a>
											<div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr">
											</div>
										</div>
									</div>
									<div class="sectionblock">
									
										<table id="memberList" class="members">
											<tbody>
												<tr>
													<th class="iconColumn">&nbsp;</th>
													<th class="nameColumn">Name</th>
													<th class="descriptionColumn">Description</th>
												</tr>
												<tr>									
													<td>		
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic" alt="">
														</div>
													</td>
													<td>
														<a href='RotairObject.rotAppLockingObject.Constructor.html'>rotAppLockingObject(String)</a>
													</td>
													<td>
														Initializes a new instance of a rotAppLockingObject for the specified domain.
													</td>
												</tr>
												<tr>									
													<td>		
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic" alt="">
														</div>
													</td>
													<td>
														<a href='RotairObject.rotAppLockingObject.Constructor.html'>rotAppLockingObject(String, Boolean)</a>
													</td>
													<td>
														Initializes a new instance of a rotAppLockingObject for the specified domain indicating whether 
														change tracking is used.
													</td>
												</tr>
												<tr>									
													<td>		
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic" alt="">
														</div>
													</td>
													<td>
														<a href='RotairObject.rotAppLockingObject.Constructor.html'>rotAppLockingObject(String, Boolean, Boolean)</a>
													</td>
													<td>
														Initializes a new instance of a rotAppLockingObject for the specified domain indicating whether 
														change tracking is used and if the object is read-only.
													</td>
												</tr>
												<tr>									
													<td>		
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic" alt="">
														</div>
													</td>
													<td>
														<a href='RotairObject.rotAppLockingObject.Constructor.html'>rotAppLockingObject(String, Boolean, Boolean, Boolean)</a>
													</td>
													<td>
														Initializes a new instance of a rotAppLockingObject for the specified domain indicating whether 
														change tracking is used and if the object is read-only and if it already exists in the database.
													</td>
												</tr>
											</tbody>
										</table>
										
										<a href="#mainBody">Top</a>
									</div>
								</div>
	
								<div xmlns="">
									<div class="LW_CollapsibleArea_TitleDiv">
										<div id='Properties'>
											<a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Collapse">
											<span class="LW_CollapsibleArea_Title">Properties</span></a>
											<div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr">
											</div>
										</div>
									</div>
									<div class="sectionblock">
									
										<p>In addition to <a href='RotairObject.rotAppObject.html#Properties'>Properties</a> supported by the base.</p>
									
										<table id="memberList1" class="members">
											<tbody>
												<tr>
													<th class="iconColumn">&nbsp;</th>
													<th class="nameColumn">Name</th>
													<th class="descriptionColumn">Description</th>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.IsLockedLink.html">IsLockedLink</a>
													</td>
													<td>
														Write-Only.  Provided by the derived class, a dynamic link (at run time) to the data manager accessable by the base class to query locks.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.LockedBy.html">LockedBy</a>
													</td>
													<td>
														Employee ID of the user that requested the lock.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.LockLink.html">LockLink</a>
													</td>
													<td>
														Write-Only.  Provided by the derived class, a dynamic link (at run time) to the data manager accessable by the base class to create a lock.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.LockKey.html">LockKey</a>
													</td>
													<td>
														The string used to uniquely identify the record to be locked.  Usually the primary key, can be a single field or a composite key.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.LockedOnHost.html">LockedOnHost</a>
													</td>
													<td>
														The machine name where the lock request originated.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.RemovelockLink.html">RemovelockLink</a>
													</td>
													<td>
														Write-Only.  Provided by the derived class, a dynamic link (at run time) to the data manager accessable by the base class to delete a lock.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.RequestingDomain.html">RequestingDomain</a>
													</td>
													<td>
														Domain that requested the lock.  Not used by the customizations, however, this field exists in the lock table.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.SetLocked.html">SetLocked</a>
													</td>
													<td>
														Write-Only.  Sets the locked flag.
													</td>
												</tr>
												<tr>
													<td>
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class='property_pic' alt=''>
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.UnlockIfOwnedLink.html">UnlockIfOwnedLink</a>
													</td>
													<td>
														Write-Only.  Provided by the derived class, a dynamic link (at run time) to the data manager accessable by the base class to delete a lock only if 
														a request for a lock has been issued and that same record is locked by the same user on the same machine.
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
								<a href="#mainBody">Top</a>
						
								<div xmlns="">
									<div class="LW_CollapsibleArea_TitleDiv">
										<div id='Methods'>
											<a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Collapse">
											<span class="LW_CollapsibleArea_Title">Methods</span></a>
											<div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div>
										</div>
									</div>
									<div class="sectionblock">

										<p>In addition to <a href='RotairObject.rotAppObject.html#Methods'>Methods</a> supported by the base.</p>
									
										<table id="memberList2" class="members">
											<tbody>
												<tr>
													<th class="iconColumn">&nbsp;</th>
													<th class="nameColumn">Name</th>
													<th class="descriptionColumn">Description</th>
												</tr>
												<tr>		
													<td>		  
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic">
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.Delete.html">Delete</a>
													</td>
													<td>
														Calls the delete function in the data manager if the object is in a deletable state.
													</td>
												</tr>
												<tr>		
													<td>		  
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic">
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.Finalize.html">Finalize</a>
													</td>
													<td>
														Automatically called when an object disposes of itself to remove a lock that if one has been issued.
													</td>
												</tr>
												<tr>		
													<td>		  
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic">
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.IsLocked.html">IsLocked</a>
													</td>
													<td>
														Returns the locked flag.
													</td>
												</tr>
												<tr>		
													<td>		  
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic">
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.Load.html">Load</a>
													</td>
													<td>
														Loads the object from the database.
													</td>
												</tr>
												<tr>		
													<td>		  
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic">
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.OKToDelete.html">OKToDelete</a>
													</td>
													<td>
														Returns TRUE if the object is in a state where deletes are allowed.
													</td>
												</tr>
												<tr>		
													<td>		  
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic">
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.OKToSave.html">OKToSave</a>
													</td>
													<td>
														Returns TRUE if the object is in a state where saves are allowed.
													</td>
												</tr>
												<tr>		
													<td>		  
														<div class="clip25x25" id="imagecenter25">
															<img src="Graphics/Graphics.png" class="function_pic">
														</div>
													</td>
													<td>
														<a href="RotairObject.rotAppLockingObject.Save.html">Save</a>
													</td>
													<td>
														Saves the object to the database.
													</td>
												</tr>
											</tbody>
										</table>
										
										<a href="#mainBody">Top</a>
									</div>
								</div>

								<div xmlns="">
									<div class="LW_CollapsibleArea_TitleDiv">
										<div>
											<a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Collapse">
											<span class="LW_CollapsibleArea_Title">Remarks</span></a>
											<div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div>
										</div>
									</div>
									<div class="sectionblock">
									
										A <b>rotAppLockingObject</b> is a class derived from <a href="rotAppObject.html">rotAppObject</a>.  It provides added functionality to streamline logical locking.  Along with the benefits 
										provided by the <a href="rotAppObject.html#AppObjectBenefits">base class</a>.<br>
										If the record that is requested is not specified as read-only and is locked by another user (or the same user on a different machine) then 
										a read-only version is returned.  It can take several minutes for the lock to be removed (Finalize to run) after the user is done with the record.
				
										<h3>Orphaned Locks</h3>
										Every object that inherits from <b>rotAppLockingObject</b> will automatically handle logical locking if the read-only flag is FALSE.  Setting the flag to TRUE will cancel
										all locking along with the capability to save or delete.
										<br>
										This class also handles orphaned locks in two ways.
										<br>
										
										<ol type = '1'>
										<li>On load</li>
										<li>On Finalize</li>
										</ol>
										<br>
										
										<h3>1. Load</h3>
										When the object is requested (not in read-only mode) if there is an existing lock and the lock is from the same user on the same machine (orphaned lock) it will 
										delete the orphaned lock and create a new one.  This should only happen if the machine is powered off or crashes before garbage collection is run.
										<br>
										<br>
										
										<h3>2. Finalize</h3>
										This is where the lock is cleared.  Once all references are destroyed (set to nothing or go out of scope) the object is available for garbage collection.  
										The problem with this is that the finalize method can take seconds or minutes to run.  So an outstanding lock can exist after the user is done witb the
										record.  You can speed things up by closing the application, but if you actually save any time is uncertain.
										<br>
										<br>
																													
									</div>

									<div xmlns="">
										<div class="LW_CollapsibleArea_TitleDiv">
											<div>
												<a href="javascript:void(0)" class="LW_CollapsibleArea_TitleAhref" title="Collapse">
												<span class="LW_CollapsibleArea_Title">Example</span></a>
												<div class="LW_CollapsibleArea_HrDiv"><hr class="LW_CollapsibleArea_Hr"></div>
											</div>
										</div>
										<div class="sectionblock">
										
											To use just inherit like the example in the syntax section above.  Ensure you have a unique value for the Domain property as this is used in the locking table.  
											Then you must Shadow the <a href='Broke.html'>KeyComposite</a> function passing what ever field(s) 
											you wish for the distinct locking key.  In the example one field, <i>mstrKeyField</i>, is used but more than one can be used.
											Right before you call the <a href='Broke.html'>Load</a> function you must call the KeyComposite function and set its return value to the 
											<a href='Broke.html'>LoackKey</a> property.
											While you can put the code to build the key in the Load function, that is a poor choice.  
											It makes the interface unclear, Load does more than load. Also where is the key set?  Doing it this way the key building code and load code are encapsulated in their own functions.  
											It makes maintenance and debugging much easier.  Good function design produces a function that does one and only one task.
										
										</div>
									</div>

									<div class="sectionblock">
										<div class="codeSnippetContainer">  	  
											<div class="codeSnippetContainerTabs">
												<div class="codeSnippetContainerTab codeSnippetContainerTabActive codeSnippetContainerTabLast" dir="ltr">
													<a>VB</a>
												</div>
											</div>
											<div class="codeSnippetContainerCodeContainer">
												<div class="codeSnippetToolBar">
												</div>
												<div class="codeSnippetContainerCode">
													<div style="color: Black;">
														<pre><span style="color: Green;">'A derived class shadowing the KeyComposite function.</span></pre>
														<pre><span style="color: Blue;">Public Shadows Function</span>(KeyComposite)<span style="color: Blue;"> As String</span></pre>
														<br>
														<pre>    <span style="color: Blue;">Return MyBase</span>.KeyComposite(<span style="color: Blue;">New String</span>() {mstrKeyField})</pre>
														<br>
														<pre><span style="color: Blue;">End Function</span></pre>		
														<br>
														<br>
														<pre><span style="color: Green;">'The Load function needs to set the lock key before it calls the base.</span></pre>
														<pre><span style="color: Blue;">Public Overrides Function</span> Load() <span style="color: Blue;">As</span> eLoadResultType</pre>
														<br>
														<pre>    LockKey = KeyComposite()</pre>
														<pre>    <span style="color: Blue;">Return MyBase</span>.Load()</pre>
														<br>
														<pre><span style="color: Blue;">End Function</span></pre>		
													</div>																	
												</div>
											</div>
										</div>

									</div>	
								</div>	
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script type="text/javascript" src="Scripts/Combined.js"></script>

	</body>
</html>

